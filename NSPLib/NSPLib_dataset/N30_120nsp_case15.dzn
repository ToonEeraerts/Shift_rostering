amountOfEmployees = 30;
horizonLength = 28;
amountOfShifts = 4;

shiftsPerDay = [|20,0,5,0,
|7,0,2,0,
|2,3,0,0,
|1,0,5,0,
|5,21,0,0,
|18,0,4,0,
|5,21,0,0,
|1,1,0,0,
|22,4,2,0,
|2,19,3,0,
|3,0,1,0,
|0,0,0,0,
|19,2,3,0,
|16,4,0,0,
|0,0,0,0,
|1,2,0,0,
|3,5,0,0,
|1,0,5,0,
|1,0,0,0,
|5,0,19,0,
|19,2,3,0,
|4,2,21,0,
|4,16,0,0,
|18,0,4,0,
|1,0,5,0,
|0,0,0,0,
|0,6,24,0,
|6,22,0,0,
|];

preferences = array3d(1..30,1..28,1..4,[2,4,4,4,3,3,3,3,2,4,4,4,2,4,4,4,2,4,4,4,3,3,3,3,2,4,4,4,3,3,3,3,2,4,4,4,2,4,4,4,3,3,3,3,2,4,4,4,2,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,4,4,4,3,3,3,3,2,4,4,4,2,4,4,4,2,4,4,4,2,4,4,4,2,4,4,4,2,4,4,4,4,2,3,3,1,4,4,1,4,2,2,3,4,2,2,3,4,2,2,3,1,4,4,1,4,2,2,3,1,4,4,1,4,2,2,3,4,2,3,3,1,4,4,1,4,2,3,3,4,2,3,3,1,4,4,1,1,4,4,1,1,4,4,1,1,4,4,1,1,4,4,1,1,4,4,1,1,4,4,1,4,2,2,3,1,4,4,1,4,2,3,3,4,2,3,3,4,2,2,3,4,2,2,3,4,2,3,3,4,2,3,3,3,2,2,2,4,2,2,4,3,2,2,2,3,2,2,2,3,2,2,2,4,2,2,4,3,2,2,2,4,2,2,4,3,2,2,2,3,2,2,2,4,2,2,4,3,2,2,2,3,2,2,2,4,2,2,4,4,2,2,4,4,2,2,4,4,2,2,4,4,2,2,4,4,2,2,4,4,2,2,4,3,2,2,2,4,2,2,4,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,2,2,3,3,3,2,3,3,3,2,2,3,3,2,2,3,3,2,2,3,3,2,3,3,3,2,2,3,3,2,3,3,3,2,2,3,2,2,3,3,3,2,3,3,2,2,3,3,2,2,3,3,3,2,3,3,3,2,3,3,3,2,3,3,3,2,3,3,3,2,3,3,3,2,3,3,3,2,3,3,3,2,2,3,3,2,3,3,2,2,3,3,2,2,3,3,3,2,2,3,3,2,2,3,2,2,3,3,2,2,3,3,2,1,3,3,2,2,4,2,2,1,1,3,2,1,1,3,2,1,1,3,2,2,4,2,2,1,1,3,2,2,4,2,2,1,1,3,2,1,3,3,2,2,4,2,2,1,3,3,2,1,3,3,2,2,4,2,2,2,4,2,2,2,4,2,2,2,4,2,2,2,4,2,2,2,4,2,2,2,4,2,2,1,1,3,2,2,4,2,2,1,3,3,2,1,3,3,2,1,1,3,2,1,1,3,2,1,3,3,2,1,3,3,4,4,4,4,1,2,1,1,4,4,4,4,4,4,4,4,4,4,4,4,1,2,1,1,4,4,4,4,1,2,1,1,4,4,4,4,4,4,4,4,1,2,1,1,4,4,4,4,4,4,4,4,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,1,4,4,4,4,1,2,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,2,2,2,3,3,2,3,3,2,2,2,3,2,2,2,3,2,2,2,3,3,2,3,3,2,2,2,3,3,2,3,3,2,2,2,3,2,2,2,3,3,2,3,3,2,2,2,3,2,2,2,3,3,2,3,3,3,2,3,3,3,2,3,3,3,2,3,3,3,2,3,3,3,2,3,3,3,2,3,3,2,2,2,3,3,2,3,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,2,2,2,2,1,1,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,2,2,2,2,1,1,2,1,2,2,2,2,2,2,2,2,1,1,2,1,2,2,2,2,2,2,2,2,1,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,2,2,2,2,1,1,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,1,3,3,4,3,2,4,3,1,1,3,3,1,1,3,3,1,1,3,4,3,2,4,3,1,1,3,4,3,2,4,3,1,1,3,3,1,3,3,4,3,2,4,3,1,3,3,3,1,3,3,4,3,2,4,4,3,2,4,4,3,2,4,4,3,2,4,4,3,2,4,4,3,2,4,4,3,2,4,3,1,1,3,4,3,2,4,3,1,3,3,3,1,3,3,3,1,1,3,3,1,1,3,3,1,3,3,3,1,3,3,3,1,3,3,3,1,4,3,3,1,1,3,3,1,1,3,3,1,1,3,3,1,4,3,3,1,1,3,3,1,4,3,3,1,1,3,3,1,3,3,3,1,4,3,3,1,3,3,3,1,3,3,3,1,4,3,3,1,4,3,3,1,4,3,3,1,4,3,3,1,4,3,3,1,4,3,3,1,4,3,3,1,1,3,3,1,4,3,3,1,3,3,3,1,3,3,3,1,1,3,3,1,1,3,3,1,3,3,3,1,3,3,2,2,2,2,1,1,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,2,2,2,2,1,1,2,1,2,2,2,2,2,2,2,2,1,1,2,1,2,2,2,2,2,2,2,2,1,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,2,2,2,2,1,1,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,1,3,3,3,3,3,3,3,1,1,3,3,1,1,3,3,1,1,3,3,3,3,3,3,1,1,3,3,3,3,3,3,1,1,3,3,1,3,3,3,3,3,3,3,1,3,3,3,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,1,3,3,3,3,3,3,1,3,3,3,1,3,3,3,1,1,3,3,1,1,3,3,1,3,3,3,1,3,3,4,4,1,1,3,1,1,3,1,4,4,1,1,4,4,1,1,4,4,1,3,1,1,3,1,4,4,1,3,1,1,3,1,4,4,1,4,4,1,1,3,1,1,3,4,4,1,1,4,4,1,1,3,1,1,3,3,1,1,3,3,1,1,3,3,1,1,3,3,1,1,3,3,1,1,3,3,1,1,3,1,4,4,1,3,1,1,3,4,4,1,1,4,4,1,1,1,4,4,1,1,4,4,1,4,4,1,1,4,4,1,1,1,2,1,1,2,4,2,2,1,2,2,1,1,2,2,1,1,2,2,1,2,4,2,2,1,2,2,1,2,4,2,2,1,2,2,1,1,2,1,1,2,4,2,2,1,2,1,1,1,2,1,1,2,4,2,2,2,4,2,2,2,4,2,2,2,4,2,2,2,4,2,2,2,4,2,2,2,4,2,2,1,2,2,1,2,4,2,2,1,2,1,1,1,2,1,1,1,2,2,1,1,2,2,1,1,2,1,1,1,2,1,1,3,3,3,3,2,2,3,2,3,3,3,3,3,3,3,3,3,3,3,3,2,2,3,2,3,3,3,3,2,2,3,2,3,3,3,3,3,3,3,3,2,2,3,2,3,3,3,3,3,3,3,3,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,3,3,3,3,2,2,3,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,1,2,2,2,3,2,2,2,1,1,2,2,1,1,2,2,1,1,2,2,3,2,2,2,1,1,2,2,3,2,2,2,1,1,2,2,1,2,2,2,3,2,2,2,1,2,2,2,1,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,1,1,2,2,3,2,2,2,1,2,2,2,1,2,2,2,1,1,2,2,1,1,2,2,1,2,2,2,1,2,2,3,4,3,3,2,1,2,2,3,4,4,3,3,4,4,3,3,4,4,3,2,1,2,2,3,4,4,3,2,1,2,2,3,4,4,3,3,4,3,3,2,1,2,2,3,4,3,3,3,4,3,3,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,3,4,4,3,2,1,2,2,3,4,3,3,3,4,3,3,3,4,4,3,3,4,4,3,3,4,3,3,3,4,3,3,1,4,1,1,3,3,3,3,1,4,4,1,1,4,4,1,1,4,4,1,3,3,3,3,1,4,4,1,3,3,3,3,1,4,4,1,1,4,1,1,3,3,3,3,1,4,1,1,1,4,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,4,4,1,3,3,3,3,1,4,1,1,1,4,1,1,1,4,4,1,1,4,4,1,1,4,1,1,1,4,1,1,3,1,3,3,3,2,3,3,3,1,1,3,3,1,1,3,3,1,1,3,3,2,3,3,3,1,1,3,3,2,3,3,3,1,1,3,3,1,3,3,3,2,3,3,3,1,3,3,3,1,3,3,3,2,3,3,3,2,3,3,3,2,3,3,3,2,3,3,3,2,3,3,3,2,3,3,3,2,3,3,3,1,1,3,3,2,3,3,3,1,3,3,3,1,3,3,3,1,1,3,3,1,1,3,3,1,3,3,3,1,3,3,3,2,3,3,3,3,3,3,3,2,2,3,3,2,2,3,3,2,2,3,3,3,3,3,3,2,2,3,3,3,3,3,3,2,2,3,3,2,3,3,3,3,3,3,3,2,3,3,3,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,3,3,3,3,3,3,2,3,3,3,2,3,3,3,2,2,3,3,2,2,3,3,2,3,3,3,2,3,3,2,4,2,2,2,3,2,2,2,4,4,2,2,4,4,2,2,4,4,2,2,3,2,2,2,4,4,2,2,3,2,2,2,4,4,2,2,4,2,2,2,3,2,2,2,4,2,2,2,4,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,4,4,2,2,3,2,2,2,4,2,2,2,4,2,2,2,4,4,2,2,4,4,2,2,4,2,2,2,4,2,2,2,4,2,2,4,3,1,4,2,4,4,2,2,4,4,2,2,4,4,2,4,3,1,4,2,4,4,2,4,3,1,4,2,4,4,2,2,4,2,2,4,3,1,4,2,4,2,2,2,4,2,2,4,3,1,4,4,3,1,4,4,3,1,4,4,3,1,4,4,3,1,4,4,3,1,4,4,3,1,4,2,4,4,2,4,3,1,4,2,4,2,2,2,4,2,2,2,4,4,2,2,4,4,2,2,4,2,2,2,4,2,2,4,1,4,4,2,1,3,2,4,1,1,4,4,1,1,4,4,1,1,4,2,1,3,2,4,1,1,4,2,1,3,2,4,1,1,4,4,1,4,4,2,1,3,2,4,1,4,4,4,1,4,4,2,1,3,2,2,1,3,2,2,1,3,2,2,1,3,2,2,1,3,2,2,1,3,2,2,1,3,2,4,1,1,4,2,1,3,2,4,1,4,4,4,1,4,4,4,1,1,4,4,1,1,4,4,1,4,4,4,1,4,4,4,1,4,4,2,3,2,2,4,1,1,4,4,1,1,4,4,1,1,4,2,3,2,2,4,1,1,4,2,3,2,2,4,1,1,4,4,1,4,4,2,3,2,2,4,1,4,4,4,1,4,4,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,2,3,2,2,4,1,1,4,2,3,2,2,4,1,4,4,4,1,4,4,4,1,1,4,4,1,1,4,4,1,4,4,4,1,4,4,1,4,1,1,3,2,2,3,1,4,4,1,1,4,4,1,1,4,4,1,3,2,2,3,1,4,4,1,3,2,2,3,1,4,4,1,1,4,1,1,3,2,2,3,1,4,1,1,1,4,1,1,3,2,2,3,3,2,2,3,3,2,2,3,3,2,2,3,3,2,2,3,3,2,2,3,3,2,2,3,1,4,4,1,3,2,2,3,1,4,1,1,1,4,1,1,1,4,4,1,1,4,4,1,1,4,1,1,1,4,1,1,2,1,2,2,2,2,2,2,2,1,1,2,2,1,1,2,2,1,1,2,2,2,2,2,2,1,1,2,2,2,2,2,2,1,1,2,2,1,2,2,2,2,2,2,2,1,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,1,2,2,2,1,2,2,2,1,1,2,2,1,1,2,2,1,2,2,2,1,2,2,2,2,2,2,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,2,2,2,2,3,3,3,3,2,2,2,2,2,2,2,2,3,3,3,3,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,4,3,3,2,2,1,2,3,4,4,3,3,4,4,3,3,4,4,3,2,2,1,2,3,4,4,3,2,2,1,2,3,4,4,3,3,4,3,3,2,2,1,2,3,4,3,3,3,4,3,3,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,3,4,4,3,2,2,1,2,3,4,3,3,3,4,3,3,3,4,4,3,3,4,4,3,3,4,3,3,3,4,3,3,2,1,2,2,3,3,3,3,2,1,1,2,2,1,1,2,2,1,1,2,3,3,3,3,2,1,1,2,3,3,3,3,2,1,1,2,2,1,2,2,3,3,3,3,2,1,2,2,2,1,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,1,1,2,3,3,3,3,2,1,2,2,2,1,2,2,2,1,1,2,2,1,1,2,2,1,2,2,2,1,2,2,2,4,2,2,1,2,1,1,2,4,4,2,2,4,4,2,2,4,4,2,1,2,1,1,2,4,4,2,1,2,1,1,2,4,4,2,2,4,2,2,1,2,1,1,2,4,2,2,2,4,2,2,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,1,2,4,4,2,1,2,1,1,2,4,2,2,2,4,2,2,2,4,4,2,2,4,4,2,2,4,2,2,2,4,2,2,]);

minShifts = 20;
maxShifts = 20;
minConsecShifts = 2;
maxConsecShifts = 5;

minConsecSameShifts = [2,2,2,1];
maxConsecSameShifts = [3,3,3,7];

minPerShifts = [0,0,0,0];
maxPerShifts = [20,20,12,24];